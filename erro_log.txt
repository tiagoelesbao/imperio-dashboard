Erro ao obter dados da API de afiliados: 400 - {"error":"Ooops!","message":"Data inicial não pode ser maior que a data final"}2025-07-22 06:48:50.865917: APIError: [400]: Range ('SCRAP ROI POR HORÁRIO'!A4557:C4557) exceeds grid limits. Max rows: 4556, max columns: 19
Traceback (most recent call last):
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 485, in executar_automacao
    executar_rotina_completa_roi()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 444, in executar_rotina_completa_roi
    executar_etapa(
    ~~~~~~~~~~~~~~^
        config['accounts'],
        ^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        ss.worksheet(config['hist_ultima'])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 407, in executar_etapa
    obter_dados_facebook_ads(account_ids, access_token, sheet_scrap_roi)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 295, in obter_dados_facebook_ads
    sheet.update(values=[[now_str, act_id, 0]], range_name=f"A{new_row}:C{new_row}", value_input_option="USER_ENTERED")
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\worksheet.py", line 1240, in update
    response = self.client.values_update(
        self.spreadsheet_id,
    ...<2 lines>...
        body={"values": values, "majorDimension": major_dimension},
    )
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\http_client.py", line 173, in values_update
    r = self.request("put", url, params=params, json=body)
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [400]: Range ('SCRAP ROI POR HORÁRIO'!A4557:C4557) exceeds grid limits. Max rows: 4556, max columns: 19

2025-07-22 09:00:50.720841: APIError: [429]: Quota exceeded for quota metric 'Read requests' and limit 'Read requests per minute per user' of service 'sheets.googleapis.com' for consumer 'project_number:1094347076698'.
Traceback (most recent call last):
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 485, in executar_automacao
    executar_rotina_completa_roi()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 444, in executar_rotina_completa_roi
    executar_etapa(
    ~~~~~~~~~~~~~~^
        config['accounts'],
        ^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        ss.worksheet(config['hist_ultima'])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 411, in executar_etapa
    adicionar_data_hora_execucao(sheet_historico)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Pichau\Desktop\Sistemas\OracleSys\Clientes\Imperio\REGISTRO_VENDAS_SCHENDULE\automacao_login_google_sheet_new.py", line 395, in adicionar_data_hora_execucao
    vals = sheet_historico.get_all_values()
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\worksheet.py", line 483, in get_all_values
    return self.get_values(
           ~~~~~~~~~~~~~~~^
        range_name=range_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        return_type=return_type,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\worksheet.py", line 460, in get_values
    return self.get(
           ~~~~~~~~^
        range_name=range_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        return_type=return_type,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\worksheet.py", line 952, in get
    response = self.client.values_get(
        self.spreadsheet_id, get_range_name, params=params
    )
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\http_client.py", line 236, in values_get
    r = self.request("get", url, params=params)
  File "C:\Users\Pichau\AppData\Local\Programs\Python\Python313\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [429]: Quota exceeded for quota metric 'Read requests' and limit 'Read requests per minute per user' of service 'sheets.googleapis.com' for consumer 'project_number:1094347076698'.

